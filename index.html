<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>„Ç§„É©„Çπ„ÉàÁî≥„ÅóËæº„Åø</title>
<meta name="robots" content="noai, noimageai, noindex, nofollow">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<style>
/* --- „Çπ„Çø„Ç§„É´„ÅØÂ§âÊõ¥„Å™„Åó --- */
body {
    background-color: #f7f9fc;
    display: flex;
    justify-content: center;
    padding: 40px;
    flex-direction: column;
    align-items: center;
}
.container {
    background: white;
    padding: 0;
    border-radius: 12px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    width: 100%;
    max-width: 700px;
    box-sizing: border-box;
}
.content-wrapper {
    padding: 15px 40px;
}
.header-image {
    display: block;
    width: 100%;
    max-height: 250px;
    object-fit: cover;
    border-top-left-radius: 12px;
    border-top-right-radius: 12px;
}
.disclaimer-container {
    padding: 15px 40px;
    border-top: 2px solid #ff91d7;
    border-bottom: 2px solid #ff91d7;
    text-align: center;
}
.disclaimer-container p {
    margin: 0;
    font-size: 14px;
    color: #000000;
    line-height: 1.6;
}
h2, h3 {
    color: #333;
}
h3 {
    font-size: 1.15em;
    font-weight: 600;
    margin-top: 40px;
    padding-bottom: 8px;
    display: flex;
    align-items: center;
    gap: 8px;
    border-bottom: 2px solid #ff91d7;
}
.section-description {
    font-size: 14px;
    color: #666;
    margin: 4px 0 12px;
}
.required-note {
    color: #FF0000;
    font-size: 12px;
}
label {
    display: block;
    margin: 6px 0;
    color: #222;
}
input[type="text"],
input[type="email"],
textarea {
    font-size: 16px;
    width: 100%;
    padding: 10px;
    margin-top: 6px;
    margin-bottom: 20px;
    border: 1px solid #ccc;
    border-radius: 6px;
    box-sizing: border-box;
}
input[type="file"] {
    margin-bottom: 10px;
}
.input-error {
    border-color: red !important;
    outline: 1px solid red;
    background-color: #fff8f8;
}
label.highlight-error {
    color: red !important;
}
.error-message {
    color: red;
    font-size: 0.9em;
    margin: -10px 0 15px;
    line-height: 1.4;
    background-color: #fff0f0;
    padding: 6px 8px;
    border: 1px solid #ffcccc;
    border-radius: 4px;
}
.total {
    font-size: 1.3em;
    font-weight: bold;
    color: #1e7c27;
    text-align: center;
    margin-top: 24px;
}
.estimate-note {
    text-align: center;
    color: #555;
    font-size: 14px;
    margin-top: 10px;
    line-height: 1.5;
}
.preview img {
    max-width: 100%;
    max-height: 200px;
    margin-top: 10px;
    border-radius: 6px;
}
.preview-note {
    color: #d66;
    font-size: 0.9em;
    text-align: center;
    width: 100%;
    margin-top: 10px;
}
#optionPreview {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    margin-top: 10px;
}
.optionImageWrapper {
    display: flex;
    flex-direction: column;
    align-items: center;
}
.optionImageWrapper .preview-note {
    font-size: 0.8em;
    margin-top: 5px;
}
#filePreviewContainer {
    margin-bottom: 20px;
    display: flex;
    flex-direction: column;
    gap: 8px;
}
.file-preview-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 8px 12px;
    background-color: #f4f4f9;
    border: 1px solid #e0e0e0;
    border-radius: 6px;
    font-size: 0.9em;
}
.file-preview-item span {
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    margin-right: 10px;
}
.file-preview-item button {
    background-color: #ff4d4d;
    color: white;
    border: none;
    border-radius: 4px;
    padding: 4px 8px;
    cursor: pointer;
    font-size: 0.8em;
    line-height: 1;
}
.file-preview-item button:hover {
    background-color: #cc0000;
}
button[type="submit"] {
    background-color: #446dff;
    color: white;
    padding: 12px 20px;
    border: none;
    border-radius: 6px;
    font-size: 1em;
    width: 10em;
    cursor: pointer;
    margin-top: 30px;
    transition: all 0.3s ease;
}
button[type="submit"][disabled] {
    background-color: #888;
    cursor: not-allowed;
}
button[type="submit"]:hover:not([disabled]) {
    background-color: #ff69b4;
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
}
#previewPanel {
    position: fixed;
    bottom: 20px;
    right: 20px;
    width: 270px;
    background: #ffffff;
    border: 1px solid #e0e0e0;
    border-top: 4px solid #ff8cc6;
    border-radius: 8px;
    box-shadow: 0 5px 18px rgba(0, 0, 0, 0.1);
    padding: 18px 22px;
    z-index: 1000;
    font-size: 13.5px;
    box-sizing: border-box;
}
#previewPanel h4 {
    font-size: 1.15em;
    color: #2c2c2c;
    margin: 0 0 16px;
    padding-bottom: 12px;
    border-bottom: 1px solid #f0f0f0;
    display: flex;
    align-items: center;
}
#previewPanel h4::before {
    content: 'üìã';
    margin-right: 8px;
    font-size: 1.1em;
    color: #ff8cc6;
}
#previewPanel p {
    margin-bottom: 10px;
    padding-bottom: 10px;
    border-bottom: 1px solid #f5f5f5;
    line-height: 1.4;
}
#previewPanel p:last-child {
    border-bottom: none;
    margin: 12px 0 0;
    padding: 12px 0 0;
    border-top: 1px solid #e9e9e9;
}
#previewPanel p strong {
    display: block;
    color: #444;
    font-weight: 600;
    margin-bottom: 6px;
    font-size: 0.9em;
}
#previewPanel p span:not(.preview-total-highlight) {
    display: block;
    color: #333;
    padding-left: 8px;
    font-size: 0.95em;
    word-break: break-word;
    line-height: 1.55;
}
#previewPanel .preview-total-highlight {
    font-size: 1.65em;
    color: #1a650e;
    font-weight: bold;
    background-color: #e6f4e3;
    padding: 7px 14px;
    border-radius: 6px;
    display: inline-block;
    text-align: left;
    border: 1px solid #c8e6c1;
    margin-top: 4px;
}
.popup-overlay {
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    background: rgba(0,0,0,0.8);
    display: none;
    align-items: center;
    justify-content: center;
    z-index: 9999;
}
.popup-overlay img {
    max-width: 90%;
    max-height: 90%;
    border-radius: 10px;
    box-shadow: 0 0 10px rgba(0,0,0,0.5);
}
.complete {
    text-align: center;
    padding: 40px;
    background-color: #fff;
    border-radius: 12px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    max-width: 500px;
    margin: 20px auto;
}
.is-hidden {
    display: none !important;
}
#closeTabButton {
    background-color: #446dff;
    color: white;
    padding: 12px 20px;
    border: none;
    border-radius: 6px;
    font-size: 1em;
    width: 10em;
    cursor: pointer;
    margin-top: 20px;
    transition: all 0.3s ease;
}
#loadingOverlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(255, 255, 255, 0.8);
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    z-index: 10000;
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.3s, visibility 0.3s;
}
.spinner {
    border: 6px solid #f3f3f3;
    border-top: 6px solid #ff69b4;
    border-radius: 50%;
    width: 50px;
    height: 50px;
    animation: spin 1s linear infinite;
}
@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}
#loadingText {
    margin-top: 20px;
    color: #555;
    font-size: 1.1em;
}
@media (max-width: 980px) {
    body { padding: 20px; }
    .content-wrapper { padding: 15px 20px; }
    .disclaimer-container { padding: 15px 20px; }
    #previewPanel {
        position: static;
        width: 100%;
        margin: 25px 0;
        padding: 15px 18px;
        box-shadow: 0 2px 10px rgba(0,0,0,0.08);
        border-top-width: 3px;
    }
    #previewPanel h4 { font-size: 1.1em; margin-bottom: 15px; padding-bottom: 10px; }
    #previewPanel h4::before { font-size: 1em; }
    #previewPanel p { margin-bottom: 8px; padding-bottom: 8px; line-height: 1.3; }
    #previewPanel p strong { font-size: 0.85em; }
    #previewPanel p span:not(.preview-total-highlight) { font-size: 0.9em; padding-left: 6px; }
    #previewPanel .preview-total-highlight { font-size: 1.55em; padding: 6px 12px; }
}
@media (max-width: 600px) {
    body { padding: 15px; }
    .content-wrapper { padding: 15px; }
    h3 { font-size: 1.1em; }
    input[type="text"], input[type="email"], textarea { padding: 12px; }
    #previewPanel { padding: 12px 15px; margin: 20px 0; }
    #previewPanel h4 { font-size: 1.05em; }
    #previewPanel .preview-total-highlight { font-size: 1.45em; }
    #previewPanel p strong { font-size: 0.8em; }
    #previewPanel p span:not(.preview-total-highlight) { font-size: 0.85em; padding-left: 5px; }
}
@media print {
    img { display: none !important; }
}
</style>
</head>
<body>

<div class="container" id="formContainer">
  <img src="https://raw.githubusercontent.com/5442mako/image-host-/main/575758226550424048.webp" alt="„Éò„ÉÉ„ÉÄ„ÉºÁîªÂÉè" class="header-image" loading="lazy" decoding="async">
  <div class="disclaimer-container">
    <p>
      ‚ÄªÊú¨„Éö„Éº„Ç∏„Å´Êé≤Ëºâ„Åï„Çå„ÅüÁîªÂÉè„ÅÆÁÑ°Êñ≠Ëª¢Ëºâ„ÉªÁÑ°Êñ≠‰ΩøÁî®„ÇíÁ¶ÅÊ≠¢„ÄÇ<br>
      ‚Äª‰∏çÊ≠£Âà©Áî®„ÅåÁô∫Ë¶ö„Åó„ÅüÂ†¥Âêà„ÄÅÊêçÂÆ≥Ë´ãÊ±Ç„ÅÆÂØæË±°„Å®„Å™„Çä„Åæ„Åô„ÄÇ
    </p>
  </div>
  <div class="content-wrapper">
    <form id="estimateForm" action="#" method="POST">
      <h3 id="illustrationTypeSectionH3">„Äê„ÅîÂ∏åÊúõ„ÅÆ„Ç§„É©„Çπ„Éà„Çø„Ç§„Éó„Äë<span class="required-note">‚ÄªÂøÖÈ†à„ÄÇ</span></h3>
      <label><input type="radio" name="type" value="5000" data-imgs="https://raw.githubusercontent.com/5442mako/image-host-/main/image196.webp"> È°î„Ç¢„ÉÉ„ÉóÔºà5,000ÂÜÜÔºâ</label>
      <label><input type="radio" name="type" value="8000" data-imgs="https://raw.githubusercontent.com/5442mako/image-host-/main/575755441817780548.webp"> „Éê„Çπ„Éà„Ç¢„ÉÉ„ÉóÔºà8,000ÂÜÜÔºâ</label>
      <label><input type="radio" name="type" value="10000" data-imgs="https://raw.githubusercontent.com/5442mako/image-host-/main/image107.webp"> ËÜù‰∏äÔºà10,000ÂÜÜÔºâ</label>
      <label><input type="radio" name="type" value="13000" data-imgs="https://raw.githubusercontent.com/5442mako/image-host-/main/„Ç§„É©„Çπ„Éà210.webp"> ÂÖ®Ë∫´Ôºà13,000ÂÜÜÔºâ</label>
      <label><input type="radio" name="type" value="40000" > Live2DÁî®„Ç§„É©„Çπ„Éà„Éë„Éº„ÉÑÂàÜ„ÅëÔºà40,000ÂÜÜÔºâ</label>
      <label><input type="radio" name="type" value="25000" > Live2D„Éê„Çπ„Éà„Ç¢„ÉÉ„ÉóÔºà25,000ÂÜÜÔºâ</label>
      <label><input type="radio" name="type" value="15000" > „Ç≠„É£„É©„ÉªË°£Ë£Ö„Éá„Ç∂„Ç§„É≥Ôºà15,000ÂÜÜÔºâ</label>
      <p id="typeErrorMessage" class="error-message is-hidden">‚Äª„ÅîÂ∏åÊúõ„ÅÆ„Ç§„É©„Çπ„Éà„Çø„Ç§„Éó„ÇíÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ</p>
      <div id="typeImageBelowOptions" class="preview"></div>

      <h3>„ÄêËøΩÂä†„Ç™„Éó„Ç∑„Éß„É≥ÔºàË§áÊï∞ÈÅ∏ÊäûÂèØÔºâ„Äë<span class="required-note">‚ÄªÂøÖÈ†à„ÄÇ</span></h3>
      <label><input type="checkbox" class="option additional-option-item" name="additionalOption" value="3000" data-imgs="https://raw.githubusercontent.com/5442mako/image-host-/main/image209.webp"> ËÉåÊôØÔºà3,000ÂÜÜ„ÄúÔºâ</label>
      <label><input type="checkbox" class="option additional-option-item" name="additionalOption" value="15000" data-imgs="https://raw.githubusercontent.com/5442mako/image-host-/main/image216.webp"> Á¥∞„Åã„ÅÑËÉåÊôØÔºà15,000ÂÜÜ„ÄúÔºâ</label>
      <label><input type="checkbox" class="option additional-option-item" name="additionalOption" value="5000" > Á¥∞„Åã„ÅÑË£ÖÈ£æÔºà5,000ÂÜÜÔºâ</label>
      <label><input type="checkbox" class="option additional-option-item" name="additionalOption" value="5000" > „Å¨„ÅÑ„Åê„Çã„ÅøÔºàÂãïÁâ©„Å™„Å©Ôºâ„ÉªÂ§ß„Åç„ÇÅ„Ç¢„ÇØ„ÇªÔºà5,000ÂÜÜÔºâ</label>
      <label><input type="checkbox" class="option additional-option-item" name="additionalOption" value="10000"> ËøΩÂä†Ë°£Ë£ÖÔºà1ÁùÄ„Åî„Å®10,000ÂÜÜÔºâ</label>
      <label><input type="checkbox" class="option additional-option-item" name="additionalOption" value="5000"> ÂïÜÁî®Âà©Áî®Ôºà5,000ÂÜÜÔºâ</label>
      <label><input type="checkbox" class="option" id="noOptionCheckbox" name="additionalOption" value="0"> ËøΩÂä†„Ç™„Éó„Ç∑„Éß„É≥„Å™„Åó</label>
      <div id="optionPreview" class="preview"></div>

      <h3>„ÄêÂêàË®à„Äë</h3>
      <div class="total">Á∞°ÊòìË¶ãÁ©çÂêàË®àÈáëÈ°çÔºö¬•<span id="total">0</span></div>
      <div class="estimate-note">
        ‚Äª„Åì„ÅÆÈáëÈ°ç„ÅØ„ÅÇ„Åè„Åæ„ÅßÁõÆÂÆâ„Åß„Åô„ÄÇ<br>
        ‚ÄªÂÆüÈöõ„ÅÆË≤ªÁî®„ÅØÂÜÖÂÆπ„ÇíÁ¢∫Ë™ç„ÅÆ„ÅÜ„Åà„ÄÅ<br>Ê≠£Âºè„Å´„ÅäË¶ãÁ©ç„ÇÇ„Çä„Åï„Åõ„Å¶„ÅÑ„Åü„Å†„Åç„Åæ„Åô„ÄÇ
      </div>
      
      <h3 id="contactInfoSectionH3">„Äê„ÅîÈÄ£Áµ°ÂÖà„Äë</h3>
      <p>„ÅäÂêçÂâçor„Éè„É≥„Éâ„É´„Éç„Éº„É†<span class="required-note">‚ÄªÂøÖÈ†à„ÄÇ</span></p>
      <input type="text" id="name" placeholder="‚Äª‰æãÔºöËä±Êùü„ÅÆ‰Ωè‰∫∫„ÄÅyamada100" name="name">
      <p id="nameErrorMessage" class="error-message is-hidden">‚Äª„ÅäÂêçÂâçor„Éè„É≥„Éâ„É´„Éç„Éº„É†„Çí„ÅîÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ</p>
      <p>„É°„Éº„É´„Ç¢„Éâ„É¨„Çπ<span class="required-note">‚ÄªÂøÖÈ†à„ÄÇ</span></p>
      <input type="email" id="email" placeholder="‚Äª‰æãÔºöexample@gmail.com" name="email">
      <p id="emailErrorMessage" class="error-message is-hidden">‚ÄªÊ≠£„Åó„ÅÑ„É°„Éº„É´„Ç¢„Éâ„É¨„Çπ„Çí„ÅîÂÖ•Âäõ„Åè„Å†„Åï„ÅÑ„ÄÇ</p>
      
      <h3>„Äê„Åî‰æùÈ†ºÁî®„ÉÜ„É≥„Éó„É¨„Éº„Éà„Äë<span class="required-note">‚ÄªÂøÖÈ†à„ÄÇ</span></h3>
      <textarea id="note" placeholder="„ÅîË¶ÅÊúõ„Åå„ÅÇ„Çå„Å∞„ÅîËá™Áî±„Å´„ÅîË®òÂÖ•„Åè„Å†„Åï„ÅÑ„ÄÇ‰æãÔºöÈ´™Ëâ≤„ÉªÊúçË£Ö„ÉªÊÄßÊ†º„Ç§„É°„Éº„Ç∏Ôºè‰ΩøÁî®ÁõÆÁöÑÔºà„Ç¢„Ç§„Ç≥„É≥„ÉªLive2D„Å™„Å©ÔºâÔºè„Éù„Éº„Ç∫„ÇÑÊßãÂõ≥ÔºèËÉåÊôØ„ÅÆÊúâÁÑ° „Å™„Å©" rows="30" name="note">

ÔºçÔºçÔºçÔºçÔºçÔºçÔºçÔºçÔºçÔºçÔºçÔºçÔºçÔºçÔºçÔºçÔºçÔºçÔºçÔºçÔºçÔºç

„ÄêÁ¥çÊúü„ÄëÔºö
„ÄêÁ¥çÊúü„ÅÆÂâçÂÄí„Åó„ÅÆÂèØÂê¶„ÄëÔºö
„Äê‰ΩøÁî®Áî®ÈÄî„ÄëÔºö
„Äê„Ç§„É©„Çπ„Éà„Çµ„Ç§„Ç∫„ÄëÔºö
„Äê„Ç™„Éó„Ç∑„Éß„É≥„ÅÆÊúâÁÑ°„ÄëÔºö
„ÄêÁ¥çÂìÅÂΩ¢Âºè„ÄëÔºö
„Äê„Ç≠„É£„É©„ÅÆÂπ¥ÈΩ¢„ÄëÔºö
„Äê„ÅîÂ∏åÊúõ„ÅÆÈ†≠Ë∫´„ÄëÔºö
„Äê„ÅîÂ∏åÊúõ„ÅÆÊßãÂõ≥„ÄëÔºö
„Äê„ÅîÂ∏åÊúõ„ÅÆ„Éù„Éº„Ç∫„ÄëÔºö
„ÄêÈõ∞Âõ≤Ê∞ó„ÄëÔºö
„ÄêË°®ÊÉÖ„ÄëÔºö

„ÄêÂÆüÁ∏æÂÖ¨ÈñãÂèØËÉΩÊó•ÊôÇ„ÄëÔºö

ÔºçÔºçÔºçÔºçÔºçÔºçÔºçÔºçÔºçÔºçÔºçÔºçÔºçÔºçÔºçÔºçÔºçÔºçÔºçÔºçÔºçÔºç
‰ªªÊÑèÊ¨Ñ

‚óé„Åî‰æùÈ†ºÊ§úË®é„ÅÆÊ±∫„ÇÅÊâã„Å®„Å™„Å£„Åü„Ç§„É©„Çπ„Éà„Å™„Å©„Åå„ÅÇ„Çå„Å∞„ÅäÊïô„Åà„Åè„Å†„Åï„ÅÑ

‚óé„Åù„ÅÆ‰ªñ„ÅîÁõ∏Ë´á„Åó„Åü„ÅÑ‰∫ã„Å™„Å©„Åî„Åñ„ÅÑ„Åæ„Åó„Åü„ÅäÊïô„Åà„Åè„Å†„Åï„ÅÑ

Ë©≥Á¥∞Ë≥áÊñô„Å™„Å©„Åî„Åñ„ÅÑ„Åæ„Åó„Åü„Çâ„ÅîÊèêÁ§∫È†Ç„Åë„Åæ„Åô„Å®Âä©„Åã„Çä„Åæ„Åô„ÄÇ
„ÅäÊâãÊï∞„ÅäÊéõ„ÅëËá¥„Åó„Åæ„Åô„Åå„Å©„ÅÜ„Åû„Çà„Çç„Åó„Åè„ÅäÈ°ò„ÅÑËá¥„Åó„Åæ„Åô„ÄÇ
</textarea>
      
      <h3>„ÄêÂèÇËÄÉÁîªÂÉèÔºàÊ∑ª‰ªòÔºâ„Äë</h3>
      <input type="file" id="imageFile" accept="image/*" multiple name="imageFile">
      <p class="section-description">‚ÄªÂèÇËÄÉË≥áÊñô„Å™„Å©„ÅÇ„Çä„Åæ„Åó„Åü„ÇâÁîªÂÉè„ÇíÊ∑ª‰ªò„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ<br>Windows„ÅÆÊñπ„ÅØCtrl„Ç≠„Éº„ÄÅMac„ÅÆÊñπ„ÅØCommand„Ç≠„Éº„ÇíÊäº„Åó„Å™„Åå„Çâ„ÇØ„É™„ÉÉ„ÇØ„Åô„Çã„Åì„Å®„Åß„ÄÅË§áÊï∞„ÅÆ„Éï„Ç°„Ç§„É´„ÇíÈÅ∏Êäû„Åß„Åç„Åæ„Åô„ÄÇÔºàÊúÄÂ§ß5ÊûöÔºâ</p>
      <div id="filePreviewContainer"></div>
      <p id="fileErrorMessage" class="error-message is-hidden">‚Äª„Éï„Ç°„Ç§„É´„ÅØ5Êûö„Åæ„Åß„Åó„ÅãÈÅ∏Êäû„Åß„Åç„Åæ„Åõ„Çì„ÄÇ</p>
      <button id="submitBtn" type="submit">ÈÄÅ‰ø°</button>
    </form>
  </div>
</div>

<div id="completeMessage" class="complete is-hidden">
  <h2>ÈÄÅ‰ø°„ÅåÂÆå‰∫Ü„Åó„Åæ„Åó„ÅüÔºÅ</h2>
  <p>„ÅäÂïè„ÅÑÂêà„Çè„Åõ„ÅÑ„Åü„Å†„Åç„ÄÅ„ÅÇ„Çä„Åå„Å®„ÅÜ„Åî„Åñ„ÅÑ„Åæ„Åô„ÄÇ</p>
  <p>„ÅäÂïè„ÅÑÂêà„Çè„ÅõÂÜÖÂÆπ„ÇíÁ¢∫Ë™çÊ¨°Á¨¨„ÄÅ3Âñ∂Ê•≠Êó•‰ª•ÂÜÖ„Å´„ÅîÈÄ£Áµ°„ÅÑ„Åü„Åó„Åæ„Åô„ÄÇ</p>
  <p>3Âñ∂Ê•≠Êó•„ÇíÈÅé„Åé„Å¶„ÇÇËøî‰ø°„Åå„Å™„ÅÑÂ†¥Âêà„ÅØ„ÄÅ<br>„ÅäÊâãÊï∞„Åß„Åô„Åå„ÄÅX„ÅÆDM„Å´„Å¶„ÅîÈÄ£Áµ°„ÅÑ„Åü„Å†„Åë„Åæ„Åô„Å®Âπ∏„ÅÑ„Åß„Åô„ÄÇ</p>
</div>

<div id="loadingOverlay">
  <div class="spinner"></div>
  <div id="loadingText">ÈÄÅ‰ø°‰∏≠„Åß„Åô...„Åó„Å∞„Çâ„Åè„ÅäÂæÖ„Å°„Åè„Å†„Åï„ÅÑ„ÄÇ</div>
</div>

<div id="previewPanel">
  <h4>ÈÅ∏ÊäûÂÜÖÂÆπ„Éó„É¨„Éì„É•„Éº</h4>
  <p><strong>„Ç§„É©„Çπ„Éà„Çø„Ç§„Éó:</strong> <span id="previewType">Êú™ÈÅ∏Êäû</span></p>
  <p><strong>ËøΩÂä†„Ç™„Éó„Ç∑„Éß„É≥:</strong> <span id="previewOptions">„Å™„Åó</span></p>
  <p><strong>Á∞°ÊòìË¶ãÁ©çÂêàË®àÈáëÈ°çÔºö</strong> <span id="previewTotal" class="preview-total-highlight">0</span></p>
</div>

<div class="popup-overlay" id="popupOverlay">
  <img id="popupImage" src="" alt="Êã°Â§ßÁîªÂÉè" loading="lazy" decoding="async">
</div>

<script>
document.addEventListener('DOMContentLoaded', () => {
    // --- DOMË¶ÅÁ¥†„ÅÆÂèñÂæó ---
    const formContainer = document.getElementById("formContainer");
    const completeMessage = document.getElementById("completeMessage");
    const estimateForm = document.getElementById("estimateForm");
    const totalEl = document.getElementById("total");
    const submitBtn = document.getElementById("submitBtn");
    const optionPreviewContainer = document.getElementById("optionPreview");
    const typePreviewContainer = document.getElementById('typeImageBelowOptions');
    const radios = document.querySelectorAll('input[name="type"]');
    const allOptionCheckboxes = document.querySelectorAll('.option');
    const noOptionCheckbox = document.getElementById('noOptionCheckbox');
    const actualOptionItems = document.querySelectorAll('.additional-option-item');
    const previewPanel = document.getElementById('previewPanel');
    const popupOverlay = document.getElementById("popupOverlay");
    const popupImage = document.getElementById("popupImage");
    const previewTypeEl = document.getElementById("previewType");
    const previewOptionsEl = document.getElementById("previewOptions");
    const previewTotalEl = document.getElementById("previewTotal");
    const nameInput = document.getElementById("name");
    const emailInput = document.getElementById("email");
    const noteTextarea = document.getElementById("note");
    const imageFileInput = document.getElementById("imageFile");
    const nameErrorMessage = document.getElementById("nameErrorMessage");
    const emailErrorMessage = document.getElementById("emailErrorMessage");
    const typeErrorMessage = document.getElementById("typeErrorMessage");
    const fileErrorMessage = document.getElementById("fileErrorMessage");
    const illustrationTypeSectionH3 = document.getElementById("illustrationTypeSectionH3");
    const contactInfoSectionH3 = document.getElementById("contactInfoSectionH3");
    const filePreviewContainer = document.getElementById('filePreviewContainer');
    const loadingOverlay = document.getElementById('loadingOverlay');
    const loadingText = document.getElementById('loadingText');

    let selectedFiles = [];
    // GAS„Ç¶„Çß„Éñ„Ç¢„Éó„É™„ÅÆURL
    const gasUrl = "https://script.google.com/macros/s/AKfycbyLQx1iosCLUa58xtnfQAkFddZiR0kgVN9nAAjcrB6flj-E5_wdAlsHeGbOf3rChFhY/exec";

    const showLoading = (text) => {
        loadingText.textContent = text;
        loadingOverlay.style.opacity = '1';
        loadingOverlay.style.visibility = 'visible';
    };

    const hideLoading = () => {
        loadingOverlay.style.opacity = '0';
        loadingOverlay.style.visibility = 'hidden';
    };

    const showPopup = (src) => {
        popupImage.src = src;
        popupOverlay.style.display = "flex";
    };
    const hidePopup = () => {
        popupOverlay.style.display = "none";
    };

    const updatePreviewPanel = () => {
        const selectedTypeRadio = document.querySelector('input[name="type"]:checked');
        previewTypeEl.textContent = selectedTypeRadio ? selectedTypeRadio.parentElement.textContent.trim().replace(/Ôºà[\d,]+ÂÜÜÔºâ$/, '') : "Êú™ÈÅ∏Êäû";

        let optionsText = "„Å™„Åó";
        if (noOptionCheckbox?.checked) {
            optionsText = noOptionCheckbox.parentElement.textContent.trim().replace(/Ôºà[\d,]+ÂÜÜÔºâ$/, '');
        } else {
            const checkedOptions = Array.from(actualOptionItems).filter(opt => opt.checked);
            if (checkedOptions.length > 0) {
                optionsText = checkedOptions.map(opt => opt.parentElement.textContent.trim().replace(/Ôºà[\d,]+ÂÜÜÔºâ$/, '')).join(", ");
            }
        }
        previewOptionsEl.textContent = optionsText;
        previewTotalEl.textContent = "¬•" + totalEl.textContent;
    };

    const calculateTotal = () => {
        let total = 0;
        const selectedType = document.querySelector('input[name="type"]:checked');
        if (selectedType) total += parseInt(selectedType.value, 10);

        if (!noOptionCheckbox?.checked) {
            actualOptionItems.forEach(opt => {
                if (opt.checked) total += parseInt(opt.value, 10);
            });
        }
        totalEl.textContent = total.toLocaleString();
        updatePreviewPanel();
    };

    const createPreviewImage = (url, altText, container, isOption = false) => {
        const img = document.createElement('img');
        img.src = url;
        img.alt = altText;
        img.loading = 'lazy';
        img.decoding = 'async';
        img.style.cursor = 'pointer';
        img.style.borderRadius = '6px';
        img.onclick = () => showPopup(img.src);

        if (isOption) {
            img.style.maxWidth = "150px";
            img.style.maxHeight = "150px";
        } else {
            img.style.maxWidth = '50%';
            img.style.maxHeight = '200px';
            img.style.boxSizing = 'border-box';
            img.style.padding = '0 5px';
            img.style.display = 'inline-block';
        }

        container.appendChild(img);
    };

    const updateTypePreview = () => {
        typePreviewContainer.innerHTML = '';
        const selected = document.querySelector('input[name="type"]:checked');
        if (selected?.dataset.imgs) {
            const imageUrls = selected.dataset.imgs.split(',').map(url => url.trim()).filter(Boolean);
            if (imageUrls.length > 0) {
                imageUrls.forEach(url => createPreviewImage(url, "„Çø„Ç§„ÉóÁîªÂÉè", typePreviewContainer));
                const note = document.createElement("p");
                note.textContent = "‚ÄªÁîªÂÉè„Çí„ÇØ„É™„ÉÉ„ÇØ„Åô„Çã„Å®Êã°Â§ß„Åó„Åæ„Åô„ÄÇ";
                note.className = "preview-note";
                typePreviewContainer.appendChild(note);
            }
        }
    };

    const updateOptionPreview = () => {
        optionPreviewContainer.innerHTML = '';
        actualOptionItems.forEach(opt => {
            if (opt.checked && opt.dataset.imgs) {
                const wrapper = document.createElement("div");
                wrapper.className = "optionImageWrapper";
                createPreviewImage(opt.dataset.imgs, "„Ç™„Éó„Ç∑„Éß„É≥ÁîªÂÉè", wrapper, true);

                const note = document.createElement("p");
                note.textContent = "‚ÄªÁîªÂÉè„Çí„ÇØ„É™„ÉÉ„ÇØ„Åô„Çã„Å®Êã°Â§ß„Åó„Åæ„Åô„ÄÇ";
                note.className = "preview-note";
                wrapper.appendChild(note);
                optionPreviewContainer.appendChild(wrapper);
            }
        });
    };

    const renderFilePreview = () => {
        filePreviewContainer.innerHTML = '';
        selectedFiles.forEach((file, index) => {
            const previewItem = document.createElement('div');
            previewItem.className = 'file-preview-item';
            const fileName = document.createElement('span');
            fileName.textContent = file.name;
            const removeBtn = document.createElement('button');
            removeBtn.textContent = 'ÂâäÈô§';
            removeBtn.onclick = () => {
                selectedFiles.splice(index, 1);
                renderFilePreview();
                if (selectedFiles.length === 0) {
                    imageFileInput.value = '';
                }
            };
            previewItem.appendChild(fileName);
            previewItem.appendChild(removeBtn);
            filePreviewContainer.appendChild(previewItem);
        });
    };

    const handleSubmit = async (event) => {
        event.preventDefault();
        let hasError = false;
        let firstErrorElement = null;

        radios.forEach(input => input.parentElement.classList.remove("highlight-error"));
        typeErrorMessage.classList.add('is-hidden');
        nameInput.classList.remove("input-error");
        nameErrorMessage.classList.add("is-hidden");
        emailInput.classList.remove("input-error");
        emailErrorMessage.classList.add("is-hidden");
        fileErrorMessage.classList.add("is-hidden");

        const selectedType = document.querySelector('input[name="type"]:checked');
        if (!selectedType) {
            hasError = true;
            firstErrorElement = illustrationTypeSectionH3;
            radios.forEach(input => input.parentElement.classList.add("highlight-error"));
            typeErrorMessage.classList.remove('is-hidden');
        }

        const name = nameInput.value.trim();
        if (!name) {
            hasError = true;
            nameInput.classList.add("input-error");
            nameErrorMessage.classList.remove("is-hidden");
            if (!firstErrorElement) firstErrorElement = contactInfoSectionH3;
        }

        const email = emailInput.value.trim();
        if (!email || !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) {
            hasError = true;
            emailInput.classList.add("input-error");
            emailErrorMessage.classList.remove("is-hidden");
            if (!firstErrorElement) firstErrorElement = contactInfoSectionH3;
        }

        if (selectedFiles.length > 5) {
            hasError = true;
            fileErrorMessage.classList.remove('is-hidden');
        }

        if (hasError) {
            firstErrorElement?.scrollIntoView({ behavior: 'smooth', block: 'center' });
            return;
        }

        submitBtn.disabled = true;
        showLoading("ÈÄÅ‰ø°‰∏≠„Åß„Åô...„Åó„Å∞„Çâ„Åè„ÅäÂæÖ„Å°„Åè„Å†„Åï„ÅÑ„ÄÇ");

        const selectedTypeLabel = selectedType.parentElement.textContent.trim();
        const note = noteTextarea.value;
        const total = totalEl.textContent.replace(/,/g, '');
        const optionLabels = noOptionCheckbox.checked
            ? ['ËøΩÂä†„Ç™„Éó„Ç∑„Éß„É≥„Å™„Åó']
            : Array.from(document.querySelectorAll('.additional-option-item:checked')).map(opt => opt.parentElement.textContent.trim());

        const fileDataArray = [];
        for (const file of selectedFiles) {
            const base64 = await new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = () => resolve(reader.result);
                reader.onerror = reject;
                reader.readAsDataURL(file);
            });
            fileDataArray.push({
                fileName: file.name,
                data: base64
            });
        }

        const data = {
            name: name,
            email: email,
            total: total,
            note: note,
            typeLabel: selectedTypeLabel,
            optionLabels: optionLabels,
            images: fileDataArray
        };

        try {
            const response = await fetch(gasUrl, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                // mode: 'cors' „ÇíËøΩÂä†
                mode: 'cors',
                body: JSON.stringify(data)
            });

            if (response.ok) {
                hideLoading();
                formContainer.classList.add("is-hidden");
                completeMessage.classList.remove("is-hidden");
                previewPanel?.classList.add("is-hidden");
            } else {
                throw new Error('GAS„Å∏„ÅÆÈÄÅ‰ø°„Å´Â§±Êïó„Åó„Åæ„Åó„Åü„ÄÇ');
            }
        } catch (error) {
            hideLoading();
            submitBtn.disabled = false;
            alert("ÈÄÅ‰ø°„Å´Â§±Êïó„Åó„Åæ„Åó„Åü„ÄÇ\n\n" + error.message);
        }
    };

    // --- „Ç§„Éô„É≥„Éà„É™„Çπ„Éä„Éº„ÅÆË®≠ÂÆö ---
    radios.forEach(radio => {
        radio.addEventListener('change', () => {
            calculateTotal();
            updateTypePreview();
        });
    });

    allOptionCheckboxes.forEach(checkbox => {
        checkbox.addEventListener('change', () => {
            if (checkbox.id === 'noOptionCheckbox') {
                actualOptionItems.forEach(item => {
                    item.disabled = checkbox.checked;
                    if (checkbox.checked) {
                        item.checked = false;
                    }
                });
            } else {
                if (checkbox.checked) {
                    noOptionCheckbox.checked = false;
                }
            }
            calculateTotal();
            updateOptionPreview();
        });
    });

    // „Éï„Ç°„Ç§„É´ÈÅ∏ÊäûÊôÇ„ÅÆ„Ç§„Éô„É≥„Éà
    imageFileInput.addEventListener('change', (event) => {
        fileErrorMessage.classList.add("is-hidden");
        const newFiles = Array.from(event.target.files);

        if (newFiles.length > 5) {
            fileErrorMessage.classList.remove('is-hidden');
            imageFileInput.value = '';
            selectedFiles = [];
        } else {
            selectedFiles = newFiles;
        }
        renderFilePreview();
    });

    estimateForm.addEventListener('submit', handleSubmit);
    popupOverlay.addEventListener('click', hidePopup);

    // Responsive panel movement
    const originalPreviewPanelParent = previewPanel?.parentElement;
    const originalPreviewPanelNextSibling = previewPanel?.nextSibling;
    const movePreviewPanel = () => {
        if (!previewPanel || !estimateForm || !submitBtn) return;
        if (window.innerWidth <= 980) {
            if (previewPanel.parentElement !== estimateForm) {
                estimateForm.insertBefore(previewPanel, submitBtn);
            }
        } else {
            if (previewPanel.parentElement === estimateForm) {
                originalPreviewPanelParent.insertBefore(previewPanel, originalPreviewPanelNextSibling);
            }
        }
    };
    window.addEventListener('resize', movePreviewPanel);

    // ÂàùÊúüÂåñ
    calculateTotal();
    updateTypePreview();
    updateOptionPreview();
    movePreviewPanel();
});
</script>
</body>
</html>
